#include<stdio.h>

int main(int argc, char *argv[]){

    int *heap1, *heap2;
    int size = 0x20;
    char buffer[1000];
    puts("[+] Making Duplicate");
    
    heap1 = malloc(8);
    heap2 = malloc(8);

    free(heap1);
    free(heap2);
    free(heap1);

    unsigned long long *heap3 = malloc(8);
    printf("[+] Heap3(=heap1) addr : %p\n", heap3);
    printf("[+] Size addr : %p\n\n", &size);
    printf("[+] Overwrite Heap1's fd\n");
    *heap3 = (unsigned long long)( (char*)&size - sizeof(heap3) );

    puts("[+] Malloc twice");
    malloc(8);
    malloc(8);

    printf("[+] Than we got : %p\n", malloc(8));
    
    return 0;
}